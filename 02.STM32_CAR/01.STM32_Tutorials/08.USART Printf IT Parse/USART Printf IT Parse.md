# USART Printf IT Parse

教程简要说明使用USART2中断接收并解析指定数据，最后通过USART1发送数据。

```
程序启动USART1打印Hello!
KEY和KEY2保留按键控制LED功能，KEY按键按下控制KED并打印LED Toggle
USART2接收并解析指定数据，使用USART1发送数据并根据指定数据位控制LED亮灭
```

## 开发思路

硬件连接（硬件原理图） → 引脚驱动（数据手册）→ 外设控制（参考手册）

软件配置：硬件时钟 → 配置硬件模式 → 硬件使能

### 硬件连接

| 开发板             | 引脚 | 外设      | 硬件连接            |
| ------------------ | ---- | --------- | ------------------- |
| STM32F103C8T6/RCT6 | PA2  | USART2_TX | 可接USB转TTL模块RXD |
| STM32F103C8T6/RCT6 | PA3  | USART2_RX | 可接USB转TTL模块TXD |

### 引脚驱动

引脚的默认和复用功能对应不同的初始化方式。

| 开发板             | 引脚 | 主功能（复位后） | 默认复用功能                  | 重定义功能 |
| ------------------ | ---- | ---------------- | ----------------------------- | ---------- |
| STM32F103C8T6/RCT6 | PA2  | PA2              | USART2_TX/ ADC12_IN2/TIM2_CH3 |            |
| STM32F103C8T6/RCT6 | PA3  | PA3              | USART2_RX/ ADC12_IN3/TIM2_CH4 |            |

### 数据帧

| 帧头 | 功能位 | 数据位 | 校验位(功能位+数据位) | 帧尾 |
| ---- | ------ | ------ | --------------------- | ---- |
| 0xEF | 0xXX   | 0xXX   | XX                    | 0xFE |
| 0xEF | 0x01   | 0x01   | 0x02                  | 0xFE |

示例：控制LED

| 功能  | 帧头 | 功能位 | 数据位 | 校验位(功能位+数据位) | 帧尾 |
| ----- | ---- | ------ | ------ | --------------------- | ---- |
| LED灭 | EF   | 01     | 00     | 01                    | 0xFE |
| LED亮 | EF   | 01     | 01     | 02                    | 0xFE |

   	  	 		
